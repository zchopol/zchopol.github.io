!function(){var f="dai",c="-1",u="adBreakEnd",d="adError",n="time",s="meta",h="jw-flag-ads",v=Object.assign||function(n){return Array.prototype.slice.call(arguments,1).forEach(function(t){if(t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}),n},o=function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")},a={apiKey:"",assetKey:"",cmsID:"",debug:!1,liveAdMessage:"Playing Ad",videoID:""},g=function(){function e(t,i){for(var n in o(this,e),a)if(a.hasOwnProperty(n)){var s=t[n],h=a[n],r=typeof h;if(void 0!==s){if("boolean"!==r&&"number"!==r||(s=l(s)),typeof s!==r)throw new Error("invalid parameter: "+n+" should be a "+r);this[n]=s}else this[n]=h}this.setLocalizationOptions(i)}return e.prototype.setLocalizationOptions=function(t){var i=t.loadingAd,n=t.admessage,s=t.podmessage,h=t.cuetext;this.loadingMessage=i,this.admessage=n,this.adcounterdynamic=s,this.cuetext=h},e}();function l(t){if("true"===t)return!0;if("false"===t)return!1;var i=parseFloat(t);return isNaN(i)?t:i}var r=null;function m(t){if(r)return r;if(window.google&&google.ima&&google.ima.dai)return r=Promise.resolve();var i=["//","imasdk.googleapis.com/js/sdkloader/ima3_dai.js"];"file:"===document.location.protocol&&i.unshift("https:");var n=new t.scriptloader(i.join(""));return r=n.load().then(function(){})}var e={};function w(t,s){var h=this,i=e[s];return i||(this.jwplayerEntitlements=function(t,i,n){var s={canPlayAds:!0},h=new t.key(i),r=h.edition();if("unlimited"===r)return n(s);var e=h.token(),o=["//","entitlements.jwplayer.com","/",e,".json"];"file:"===window.location.protocol&&o.unshift("https:"),t.ajax(o.join(""),function(t){s.canPlayAds=!t||!t.response||!1!==t.response.canPlayAds,n(s)},function(){n(s)},{timeout:1e4,responseType:"json"})},e[s]=new Promise(function(i,n){h.jwplayerEntitlements(t,s,function(t){t.canPlayAds?i():n({message:"Ad Limit Reached"})})}))}var b=function(){function i(t){o(this,i),this.t=t,this.i={},this.n={},this.s=null}return i.prototype.h=function(t){return p("b"+(y(t)||t.getAdId()),this.i)},i.prototype.r=function(t){return p("b"+y(t)+"a"+t.getAdId(),this.n)},i.prototype.adEventObject=function(t){var i=t||this.s,n={client:f,viewable:this.t.getViewable()};if(!i)return n;this.s=i,n.id=this.h(i),n.adPlayId=this.r(i),n.adtitle=i.getTitle(),n.adsystem=i.getAdSystem(),n.creativetype="application/x-mpegURL",n.linear="linear";var s=i.getAdPodInfo();if(s){var h=s.getTotalAds();1<h&&(n.sequence=s.getAdPosition(),n.podcount=h),n.adposition=function(t){var i=t.getTimeOffset();{if(0===i)return"pre";if(-1===i)return"post"}return"mid"}(s)}return n},i.prototype.clearAd=function(){this.s=null},i}();function p(t,i){if(t){var n=i[t];return n||(i[t]=(s=12,n=new Array(s+1).join((Math.random().toString(36)+"00000000000000000").slice(2,18)).slice(0,s))),n}var s;return c}function y(t){var i=t.getAdPodInfo();return i?(""+i.getTimeOffset()).replace(/[-.]/g,"N"):null}var k=function(){function r(t,i,n,s){var h=this;o(this,r),this.e=t,this.o=i,this.t=n,this.a=new b(n),this.u=[],this.l=n.utils,this.f=n.getContainer(),this.c=null,this.d=null,this.v=-1,this.g=i.cmsID&&i.videoID,this.m=!this.g&&i.assetKey,this.w=null,this.b=null,this.p=null,this.y=function(t){h.k(t)},this._=s}return r.prototype.beforePlay=function(){var t=this;this.d||this.A()||(clearTimeout(this.v),this.v=setTimeout(function(){t.A()||t.T()},"3000"),this.w=this.t.getConfig().mediaElement,this.d=this.t.createInstream().init().setText(this.o.loadingMessage),this.j().catch(function(){t.T()}))},r.prototype.pause=function(){this.w&&this.w.pause()},r.prototype.resume=function(){this.w&&this.w.play()},r.prototype.T=function(){this.A()||(clearTimeout(this.v),this.P())},r.prototype.j=function(){var n=this;return m().then(function(){if(n.A())return null;var t=google.ima.dai.api.StreamEvent.Type;n.b=new google.ima.dai.api.StreamManager(n.w),n.b.setClickElement(n._),n.p=[t.CUEPOINTS_CHANGED,t.LOADED,t.AD_BREAK_STARTED,t.AD_BREAK_ENDED,t.STARTED,t.AD_PROGRESS,t.CLICK,t.COMPLETE,t.ERROR],n.b.addEventListener(n.p,n.y,!1);var i=void 0;if(n.g)(i=new google.ima.dai.api.VODStreamRequest).contentSourceId=n.o.cmsID,i.videoId=n.o.videoID;else{if(!n.m)throw new Error("Invalid options");(i=new google.ima.dai.api.LiveStreamRequest).assetKey=n.o.assetKey,n.t.off(s,n.C,n),n.t.on(s,n.C,n)}i.apiKey=n.o.apiKey,n.b.requestStream(i)})},r.prototype.D=function(t){var i=this.t.getPlaylistItem(this.t.getPlaylistIndex()),n=t.url;i.sources=[v(i.sources[0],{file:n})],this.d&&(this.d.replacePlaylistItem(i),this.T())},r.prototype.k=function(t){var i=this,n=google.ima.dai.api.StreamEvent.Type,s=this.a.adEventObject(t.getAd());switch(t.type){case n.CUEPOINTS_CHANGED:var h=this.u=t.getStreamData().cuepoints;if(h&&h.length){var r=h.filter(function(t){return 0<t.start}).map(function(t){return{begin:t.start,text:i.o.cuetext}});this.t.setCues([]).setCues(r)}break;case n.LOADED:clearTimeout(this.v),this.D(t.getStreamData());break;case n.AD_BREAK_STARTED:this.t.trigger("adBreakStart",s),this.I(!0),this.d.once("destroyed",function(){i.t.trigger(u,s),i.a.clearAd()});break;case n.AD_BREAK_ENDED:this.d.off().once("destroyed",function(){i.t.trigger(u,s),i.a.clearAd()}),this.I(!1);break;case n.STARTED:this.t.trigger("adImpression",s);var e=this.a.adEventObject(null);e.newstate="playing",this.d.setState(e);break;case n.AD_PROGRESS:if(!this.d)return;this.N(t.getStreamData().adProgressData,s);break;case n.CLICK:this.t.trigger("adClick",s),this.t.pause();break;case n.COMPLETE:this.t.trigger("adComplete",s),this.a.clearAd();break;case n.ERROR:var o=t.getStreamData().errorMessage,a=v({id:c,message:"Ad Error: "+o},s);this.t.trigger(d,a),this.a.clearAd()}},r.prototype.x=function(t){if(this.u.length){for(var i=t.position,n=-1,s=0;s<this.u.length&&!(this.u[s].start>i);s++)n=s;-1<n&&!this.u[n].played&&i!==this.u[n].start&&(this.c=i,this.t.seek(this.u[n].start))}},r.prototype.C=function(t){var i=t.metadata;this.b&&i&&this.b.onTimedMetadata(i)},r.prototype.I=function(t){var i=this;this.t.off(n,this.x,this),t?(this.l.addClass(this.f,h),this.d||(this.d=this.t.createInstream()),this.d.enableAdsMode(),this.m&&this.d.setText(this.o.liveAdMessage),this.d.off(null,null,this).on("instreamClick",function(){i._.click()},this).on("state",function(t){i.d.setState(t)},this),this.m&&(this.d.on(s,this.C,this),this.C({metadata:this.t.getItemMeta()}))):(this.l.removeClass(this.f,h),this.g&&this.t.on(n,this.x,this),this.P(),this.c&&(this.w.currentTime=this.c,this.c=null))},r.prototype.N=function(t,i){var n=t.currentTime,s=t.duration;if(i.position=n,i.duration=s,this.d.setTime(i),this.g){var h=t.adPosition,r=t.totalAds,e=this.o.admessage||"",o=this.o.adcounterdynamic||"";e=e.replace(/xx/gi,""+Math.ceil(s-n)),1<r&&(e=(o=(o=o.replace(/__AD_POD_CURRENT__/g,""+h)).replace(/__AD_POD_LENGTH__/g,""+r))+e),this.d.setText(e)}},r.prototype.P=function(){this.d&&(this.d.destroy(),this.d=null)},r.prototype.destroy=function(){clearTimeout(this.v),this.A()||(this.t.off(null,null,this),this.b&&this.b.removeEventListener(this.p,this.y,!1),this.T(),this.o=null,this.w=null,this.t=null,this.e=null)},r.prototype.A=function(){return!this.e},r}();(window.jwplayerPluginJsonp||window.jwplayer().registerPlugin)(f,"8.0",function(s,t,h){var i=s.utils,n=s.getConfig(),r=new g(t||{},n.localization.advertising),e=void 0;m(i).catch(i.noop);var o=n.key;function a(){e&&(e.destroy(),e=null)}this.version="0.4.4",v(this,s.Events),s.pauseAd=function(t){t="boolean"!=typeof t||t,e&&(t?e.pause():e.resume())},s.on("ready",function(){n.localization=s.getConfig().localization,r.setLocalizationOptions(n.localization.advertising),m(i).catch(function(){s.getAdBlock()&&l("Ad playback blocked by an ad blocker",2e4)}),u.catch(function(t){l("Ad Error: "+t.message,60002)})},this).on("playlistItem",function(t){a();var i=t.item,n=v({},r,i.daiSetting);(n.cmsID&&n.videoID||n.assetKey)&&(i.preload="none",e=new k(i,n,s,h),s.once("beforePlay",e.beforePlay,e))},this).on("destroyPlugin",a,this);var u=w.call(this,i,o);function l(t,i){a(),s.off(null,null,this),s.trigger(d,{id:c,client:f,message:t,code:900,adErrorCode:i,tag:""})}u.catch(i.noop),this.destroy=a})}();
